import { SpecialFnName } from '#src/enum/special-fn-name';
import { SubjectClassFunctionStrategy } from '#src/subject/subject-class-function-strategy';
import { SubjectConstructorStrategy } from '#src/subject/subject-constructor-strategy';
import { SubjectFunctionStrategy } from '#src/subject/subject-function-strategy';
import { fnUtil } from '#src/util/fn-util';
export const subjectService = {
    strategyFromContractFunction: (params) => {
        const { contract: { module, subjectName, fns }, fnName, term: { constructorParams }, } = params;
        const subjectFromContract = { module, subjectName };
        if (fnUtil.isConstructor(fnName)) {
            return new SubjectConstructorStrategy({ subjectFromContract });
        }
        if (Object.keys(fns ?? {}).includes(SpecialFnName.CONSTRUCTOR)) {
            if (!constructorParams) {
                throw new Error(`Missing constructorParams in contract: ${subjectName}.${fnName}`);
            }
            return new SubjectClassFunctionStrategy({ constructorParams, fnName, subjectFromContract });
        }
        return new SubjectFunctionStrategy({ fnName, subjectFromContract });
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ViamVjdC1zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3N1YmplY3Qvc3ViamVjdC1zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQTtBQUN6RCxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSw4Q0FBOEMsQ0FBQTtBQUMzRixPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQTtBQUN0RixPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQTtBQUdoRixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sbUJBQW1CLENBQUE7QUFFMUMsTUFBTSxDQUFDLE1BQU0sY0FBYyxHQUFHO0lBQzdCLDRCQUE0QixFQUFFLENBQUMsTUFBcUUsRUFBbUIsRUFBRTtRQUN4SCxNQUFNLEVBQ0wsUUFBUSxFQUFFLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQUUsRUFDdEMsTUFBTSxFQUNOLElBQUksRUFBRSxFQUFFLGlCQUFpQixFQUFFLEdBQzNCLEdBQUcsTUFBTSxDQUFBO1FBQ1YsTUFBTSxtQkFBbUIsR0FBRyxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQXlCLENBQUE7UUFDMUUsSUFBSSxNQUFNLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7WUFDbEMsT0FBTyxJQUFJLDBCQUEwQixDQUFDLEVBQUUsbUJBQW1CLEVBQUUsQ0FBQyxDQUFBO1FBQy9ELENBQUM7UUFDRCxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQztZQUNoRSxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztnQkFDeEIsTUFBTSxJQUFJLEtBQUssQ0FBQywwQ0FBMEMsV0FBVyxJQUFJLE1BQU0sRUFBRSxDQUFDLENBQUE7WUFDbkYsQ0FBQztZQUVELE9BQU8sSUFBSSw0QkFBNEIsQ0FBQyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sRUFBRSxtQkFBbUIsRUFBRSxDQUFDLENBQUE7UUFDNUYsQ0FBQztRQUVELE9BQU8sSUFBSSx1QkFBdUIsQ0FBQyxFQUFFLE1BQU0sRUFBRSxtQkFBbUIsRUFBRSxDQUFDLENBQUE7SUFDcEUsQ0FBQztDQUNELENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTcGVjaWFsRm5OYW1lIH0gZnJvbSAnI3NyYy9lbnVtL3NwZWNpYWwtZm4tbmFtZSdcbmltcG9ydCB7IFN1YmplY3RDbGFzc0Z1bmN0aW9uU3RyYXRlZ3kgfSBmcm9tICcjc3JjL3N1YmplY3Qvc3ViamVjdC1jbGFzcy1mdW5jdGlvbi1zdHJhdGVneSdcbmltcG9ydCB7IFN1YmplY3RDb25zdHJ1Y3RvclN0cmF0ZWd5IH0gZnJvbSAnI3NyYy9zdWJqZWN0L3N1YmplY3QtY29uc3RydWN0b3Itc3RyYXRlZ3knXG5pbXBvcnQgeyBTdWJqZWN0RnVuY3Rpb25TdHJhdGVneSB9IGZyb20gJyNzcmMvc3ViamVjdC9zdWJqZWN0LWZ1bmN0aW9uLXN0cmF0ZWd5J1xuaW1wb3J0IHsgdHlwZSBTdWJqZWN0RnJvbUNvbnRyYWN0LCB0eXBlIFN1YmplY3RTdHJhdGVneSB9IGZyb20gJyNzcmMvc3ViamVjdC9zdWJqZWN0LXN0cmF0ZWd5J1xuaW1wb3J0IHsgdHlwZSBBbnlDb250cmFjdCwgdHlwZSBDb250cmFjdFRlcm0gfSBmcm9tICcjc3JjL3R5cGVzL2luZGV4J1xuaW1wb3J0IHsgZm5VdGlsIH0gZnJvbSAnI3NyYy91dGlsL2ZuLXV0aWwnXG5cbmV4cG9ydCBjb25zdCBzdWJqZWN0U2VydmljZSA9IHtcblx0c3RyYXRlZ3lGcm9tQ29udHJhY3RGdW5jdGlvbjogKHBhcmFtczogeyBjb250cmFjdDogQW55Q29udHJhY3Q7IGZuTmFtZTogc3RyaW5nOyB0ZXJtOiBDb250cmFjdFRlcm0gfSk6IFN1YmplY3RTdHJhdGVneSA9PiB7XG5cdFx0Y29uc3Qge1xuXHRcdFx0Y29udHJhY3Q6IHsgbW9kdWxlLCBzdWJqZWN0TmFtZSwgZm5zIH0sXG5cdFx0XHRmbk5hbWUsXG5cdFx0XHR0ZXJtOiB7IGNvbnN0cnVjdG9yUGFyYW1zIH0sXG5cdFx0fSA9IHBhcmFtc1xuXHRcdGNvbnN0IHN1YmplY3RGcm9tQ29udHJhY3QgPSB7IG1vZHVsZSwgc3ViamVjdE5hbWUgfSBhcyBTdWJqZWN0RnJvbUNvbnRyYWN0XG5cdFx0aWYgKGZuVXRpbC5pc0NvbnN0cnVjdG9yKGZuTmFtZSkpIHtcblx0XHRcdHJldHVybiBuZXcgU3ViamVjdENvbnN0cnVjdG9yU3RyYXRlZ3koeyBzdWJqZWN0RnJvbUNvbnRyYWN0IH0pXG5cdFx0fVxuXHRcdGlmIChPYmplY3Qua2V5cyhmbnMgPz8ge30pLmluY2x1ZGVzKFNwZWNpYWxGbk5hbWUuQ09OU1RSVUNUT1IpKSB7XG5cdFx0XHRpZiAoIWNvbnN0cnVjdG9yUGFyYW1zKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBjb25zdHJ1Y3RvclBhcmFtcyBpbiBjb250cmFjdDogJHtzdWJqZWN0TmFtZX0uJHtmbk5hbWV9YClcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG5ldyBTdWJqZWN0Q2xhc3NGdW5jdGlvblN0cmF0ZWd5KHsgY29uc3RydWN0b3JQYXJhbXMsIGZuTmFtZSwgc3ViamVjdEZyb21Db250cmFjdCB9KVxuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgU3ViamVjdEZ1bmN0aW9uU3RyYXRlZ3koeyBmbk5hbWUsIHN1YmplY3RGcm9tQ29udHJhY3QgfSlcblx0fSxcbn1cbiJdfQ==